<style type="text/css">
 	body {
 		padding: 0;
 	}
</style>

<script type="text/javascript">
  
  
  $(function(){
  	if(!document.getElementById("map")) {
  		return;
  	}
  	
  	$('#headline_message').text("HELLO!");

  	var myOptions = {
  		zoom: 15,
  		center: new google.maps.LatLng(<%= @game.latitude %>, <%= @game.longitude %>),
  		mapTypeId: google.maps.MapTypeId.HYBRID,
  		mapTypeControl: true,
		disableDoubleClickZoom: true
  	};

  	// Create the main map
  	map = new google.maps.Map(document.getElementById("map"), myOptions);


	$("#logout").click(function(){
		document.location.href="/game/"+$("#layer_id").val()+"/logout?user_id="+$("#user_id").val();
	});


    GameMap.fitToRadius(<%= @game.radius %>); // todo: replace ruby template var
    
    //setup health status
    setRadiation(50);
    
    //setup tabs
    showScreen('map');
    
    //listenForPositionUpdates();
    
    var mapHeight = $(window).height() - $('#header').height() - $('#status_bar').height();
	$('#map').css("height", mapHeight);
    
    //test response to incomming messages
    var userid = $('#user_id').val();
    exposureData = {'value':30, 'player_id':userid};
    receiveExposureData(exposureData);
    messageData = {'id':0, 'content':'Hi! This is a test of messages', 'player_id':[userid]};
	receiveMessageData(messageData);    
	messageData = {'id':1, 'content':'Hi! This is another test of messages', 'player_id':[userid]};
	receiveMessageData(messageData);    
	messageData = {'id':2, 'content':'Hi! This is one last test of messages', 'player_id':[userid]};
	receiveMessageData(messageData);    
	
  });


</script>


<div id="main" data-role="page">

    	<div data-role="header" id="header">
	    	<div data-role="navbar">
				<ul>
					<li class="ui-btn-active"><a href="#" onclick="showScreen('map');">Map</a></li>
					<li><a href="#" onclick="showScreen('messages');">Messages</a></li>					
				</ul>
			</div><!-- /navbar -->
	    </div><!-- /header -->
    
  	<div data-role="content">

	<div id="wrapper">
		    <div id="status_bar" style="height:100%;width:100%">
        <div id="geiger_sound"></div>
        
        <div id="radiation_reading" style="padding:2%;float:left;width:25%;height:12ex;text-align:center">
          Radiation<br/>
          <div id="radiation_number" style="font-size : 300%">0</div>
          <div id="radiation_images">
            <img id="rad0" src="/radiation_gray.png" width="20pt"/>
            <img id="rad1" src="/radiation_gray.png" width="20pt"/>
            <img id="rad2" src="/radiation_gray.png" width="20pt"/>
            <img id="rad3" src="/radiation_gray.png" width="20pt"/>
          </div>
        </div>
        
        <div style="padding:2%;float:left;width:67%;height:12ex">
          Health
          <div id="health_bar" style="height:82%"></div>
        </div>
        
        <div style="clear:both"></div>
   </div>

	<div id="testing_bar">
	    <!-- <div id="headline_message"></div> -->
		<a href="#" onclick="testReceive('player');">MapTest</a>
		<a href="#" onclick="testReceive('health');">HealthTest</a>
		<a href="#" onclick="testReceive('exposure');">ExposureTest</a>
		<a href="#" onclick="testReceive('message');">MessageTest</a>
	</div>
		
		<div id="map" style="horizontal-align:center;"></div>

		<section id="player-info">
			<h3 id="player-score" class="team-firefighter"><span class="value"></span></h3> <!-- todo: replace ruby var skill -->
			<h3 class="message"></h3>
		</section>

	    <div id="messageListDiv">
	    
	    	<h5>Messages</h5>
	    	<ul id="task_list" class="ui-listview" data-role="listview" data-inset="true">												
	
			</ul>		
	    	
	    
	    </div>


    
      </div> <!-- wrapper -->
      
 <!-- wrapper -->
 </div> 
 </div>
     
<input type="hidden" id="layer_id" value="<%= @game.layer_id %>" />
    <input type="hidden" id="user_id" value="<%= @user_id %>" />
    <input type="hidden" id="user_skill" value="<%= @user_skill %>" />
    <input type="hidden" id="user_initials" value="<%= @user_initials %>" />
    <input type="hidden" id="group_token" value="<%= @game.layer_id %>" />
    <input type="hidden" id="game_status" value=<%= @game.is_active %> /> 
   
  