<script type="text/javascript">
  var test =  <%= @test %>
  var layerId =  <%= @game.layer_id %>;
  $(function(){
  	if(!document.getElementById("map")) {
  		return;
  	}

  	var myOptions = {
  		zoom: 15,
  		center: new google.maps.LatLng(<%= @game.latitude %>, <%= @game.longitude %>),
  		mapTypeId: google.maps.MapTypeId.MAP,
  		mapTypeControl: true,
		disableDoubleClickZoom: true
  	};

  	// Create the main map
  	map = new google.maps.Map(document.getElementById("map"), myOptions);


	$("#collapse").click(function(){
		if($("#chat-window").is(':visible')){
			$("#chat-window").hide();
			$("#collapse").val("open chatting window");
		}
		else{
			$("#chat-window").show();
			$("#collapse").val("collapse");
		}
	});

	$("#submitmsg").click(function(){	

		var clientmsg = $("#usermsg").val(); 
		sendMsg(clientmsg);		
		$("#usermsg").attr("value", "");
		return false;
	});
	
	$("#usermsg").keypress(function(event){
		if(event.which == 13){
			var clientmsg = $("#usermsg").val(); 
			sendMsg(clientmsg);		
			$("#usermsg").attr("value", "");
		}	

	});
	GameMap.fitToRadius(<%= @game.radius %>);
    
	
  });


</script> 
<div ng-controller = "panelController" >
		<div id="loading-div" ng-show="loadingIndicator">
			<div class="well col-lg-offset-3 col-lg-6"> Requesting plan from agent ...... </div>
		</div>

		<div id="map" class="col-sm-6 col-lg-6"></div>

		<div id="wedget-panel-1" class="col-sm-6 col-lg-6"  >
			<div id="active-player-wrapper" class="col-lg-12">
				<div class="row" >
					<div class = "col-lg-1">
						Icon
					</div>

					<div class = "col-lg-2">
						health
					</div>

					<div class = "col-lg-3">
						mode
					</div>
					<div class = "col-lg-3">
						communication 
					</div>
					<div class = "col-lg-3">
						response 
					</div>

				</div>


				<div class="row well well-sm" >
					<div class = "col-lg-1">
						<image src = "/img/soldier.png" height=20 width=20>
					</div>

					<div class = "col-lg-2">
						100%
					</div>

					<div class = "col-lg-3">
						<div class="btn-group btn-group-xs">
  							<button type="button" class="btn btn-default">Auto</button>
  							<button type="button" class="btn btn-default ">Manual</button>
  						</div>
					</div>

					<div class = "col-lg-3">
						<button ng-click= "toggleChatbox(0)" href="#" id="callapse" class="btn btn-default btn-xs" role="button">message </button> <span class="badge">42</span> 
					</div>

					<div class = "col-lg-3">
						accepted
					</div>
				</div>

				<div id="chat-wrapper" ng-show = "showChatbox[0]">
					<div id="chat-window"> 
						<div id="chatbox"></div> 
						<input name="usermsg" type="text" id="usermsg" size="63" />
						<input name="submitmsg" type="button"  id="submitmsg" value="Send" />
					</div>
				</div>	

				<div class="row well well-sm" >
					<div class = "col-lg-1">
						<image src = "/img/soldier.png" height=20 width=20>
					</div>

					<div class = "col-lg-2">
						100%
					</div> 
					<div class = "col-lg-3">
  						<div class="btn-group btn-group-xs" data-toggle="buttons">
  						<label class="btn btn-primary" ng-click="showPlanEditor[1] = false">
    						<input type="radio" name="options" id="option1"> Auto
  						</label>
  						<label class="btn btn-primary" ng-click="showPlanEditor[1] = true">
    						<input type="radio" name="options" id="option2"> Manual
  						</label>
						</div>
					</div>

					<div class = "col-lg-3">
						<button href="#" class="btn btn-default btn-xs" ng-click = "toggleChatbox(1)" role="button">message </button> <span class="badge">42</span> 
					</div>

					<div class = "col-lg-3">
						rejected 
					</div>
				</div>	

				<div id="chat-wrapper" ng-show = "showChatbox[1]">
					<div id="chat-window"> 
						<div id="chatbox"></div> 
						<div class="input-group">
							<input type="text" class="form-control">
      						<span class="input-group-btn">
        						<button class="btn btn-default" id="submitmsg" type="button">Send</button>
      						</span>
						</div>
					</div>
				</div>	
				
				<div  id="chat-wrapper" ng-repeat="a in constraints" ng-show="showPlanEditor[1]" >
					Should go to xx with yy 
					<a class="btn btn-default btn-xs" ng-click = "deleteConstrain()" > <span class="glyphicon glyphicon-minus"></span> </a>
				</div>



				<div  id="chat-wrapper" ng-show="showPlanEditor[1]" >
					<row>
					<div class="btn-group btn-group-xs" >
							
						<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
						should go to			
						<span class="caret"></span>
						</button>
					
							<ul class="dropdown-menu">
							<li><a href="#">should go to </a></li>
							<li><a href="#">should not go to</a></li>
						</ul>
					</div>
					Target:
					<div class="btn-group btn-group-xs" >
						
						<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
      						13
      					<span class="caret"></span>
    					</button>
					
						<ul class="dropdown-menu">
      						<li ><a href="#" ng-mouseover="map.moveToTask()">15</a></li>
      						<li><a href="#" ng-mouseover="map.moveToTask()" >18</a></li>
    					</ul>
    					
    				</div>	
				With Teammate:
    				<div class="btn-group btn-group-xs" >
    					<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
      						AA
      					<span class="caret"></span>
    					</button>

    					<ul class="dropdown-menu">
      						<li><a href="#">AA</a></li>
      						<li><a href="#">BB</a></li>
    					</ul>		
					</div>	
					</row>
					<a    class="btn btn-default btn-xs" ng-click="addConstrain()"> <span class="glyphicon glyphicon-plus"></span> </a>
				</div>

				
			</div>
			<!---->
			<div id="agent-wrapper" class="col-lg-12 alert alert-warning" >
				<div class="row">
					<button href="#" class="col-lg-2  btn btn-danger btn-sm"  ng-click = "loadPlan()" role="button">Get plan</button> 
					<div class="col-lg-4" >
					</div>
					
					<button href="#" class="col-lg-2 btn btn-danger btn-sm" role="button">Confirm Plan</button> 
					
					<div class=" col-lg-4">
					</div>
				</div>

			</div>
			
		</div>

</div> 


<input type="hidden" id="layer_id" value="<%= @game.layer_id %>" />
<input type="hidden" id="user_id" value="<%= @user_id %>" />
<input type="hidden" id="user_initials" value="<%= @user_initials %>" />
<input type="hidden" id="group_token" value="<%= @game.layer_id %>" />
<input type="hidden" id="game_status" value=<%= @game.is_active %> />
