<script type="text/javascript">
  var test =  <%= @test %>
  var layerId =  <%= @game.layer_id %>;

  $(function(){
  	if(!document.getElementById("map")) {
  		return;
  	}

  	var myOptions = {
  		zoom: 15,
  		center: new google.maps.LatLng(<%= @game.latitude %>, <%= @game.longitude %>),
  		mapTypeId: google.maps.MapTypeId.MAP,
  		mapTypeControl: true,
		disableDoubleClickZoom: true
  	};

  	// Create the main map
  	map = new google.maps.Map(document.getElementById("map"), myOptions);
    GameMap.fitToRadius(<%= @game.radius %>);

});


</script> 
<%= erb(:partialMsg, :layout => false) %>
<%= erb(:partialAgentPanel, :layout => false) %>
<div  ng-controller = "NewAssignmentCtrl">
	<div class="row">
		<div id ="map" class="col-sm-6 col-lg-6"></div>
		<div class="container col-sm-6 col-lg-6"> 
			
			<div class="row">
				<div class="col-sm-6 h5"> New Assignments </div>
				<div class="col-sm-3 h5"  data-toggle="modal" data-target="#agentModal"> Current Assignments </div>
				<div class="col-sm-2 h5"> Feedbacks </div>
			</div>

      <div class="row">
        <div class="col-sm-6"> 
          <div class="col-sm-3 btn btn-sm btn-primary" > 
            Confirm all
          </div>
          <div class="col-sm-3 btn btn-sm btn-danger" ng-click="undoAll()"> 
            Undo all
          </div>
          <div class="col-sm-3 btn btn-sm btn-info" ng-click="undoAll()"> 
            Request replan
          </div>
        </div>
      </div>

			<div class = "row"   >
				<div  class="col-sm-6 drag-container" >

          <%= erb(:partialAssignmentList, :layout => false) %>
          <%= erb(:partialIdlePlayerList, :layout => false) %>
          <%= erb(:partialUnchangedList, :layout => false) %>
          <div class="bottom-left" style="background-color:white">
          <div class = "row" >
            Unassigned Tasks:
          </div>
          <div class = "row ">  
            <div 
            class = "col-sm-1 card task-card task-draggable" 
            ng-repeat = "t in tasks | filter: filterUnassignedTasks" 
            taskId = "{{t.id}}" 
            ng-init="initD()" 
            ng-mouseover="focus(t.id)" 
            ng-mouseout="unFocus(t.id)" 
            ng-class = "getClass(t.id)"
            >
              <img ng-src = "{{getTaskIcon(t.id)}}" /> 
              
              <span class="glyphicon glyphicon-move corner"></span> 
            </div>
          </div>
          
          </div>
        </div>
	
       <%= erb(:partialPreviousList, :layout => false) %>
       <div class="bottom-right" style="background-color:white">
          <div class = "row" >
            Unassigned Tasks:
          </div>
          <div class = "row ">  
            <div class = "col-sm-1 card task-card " ng-repeat = "t in tasks | filter: filterPrevUnassignedTasks" taskId = "{{t.id}}" ng-init="initD()" ng-class="getClass(t.id)">
              <img ng-src = "{{getTaskIcon(t.id)}}"  /> 
             
            </div>
          </div>
          <div class = "row" >
            Finished tasks:
          </div>
          <div class = "row transparent-5">  
            <div class = "col-sm-1 card task-card">
              <img src = "/img/task_icon2.png" /> 
            </div>
            <div class = "col-sm-1 card task-card">
              <img src = "/img/task_icon3.png" /> 
            </div>
            <div class = "col-sm-1 card task-card">
              <img src = "/img/task_icon4.png" /> 
            </div>
          </div>
        </div>
			</div>
		</div>

	</div>
	
</div> 

<input type="hidden" id="layer_id" value="<%= @game.layer_id %>" />
<input type="hidden" id="user_id" value="<%= @user_id %>" />
<input type="hidden" id="user_initials" value="<%= @user_initials %>" />
<input type="hidden" id="group_token" value="<%= @game.layer_id %>" />
<input type="hidden" id="game_status" value=<%= @game.is_active %> />
