% This is "aamas2014.tex", a revised version of aamas2013.tex
% This file should be compiled with "aamas2014.cls"
% This example file demonstrates the use of the 'aamas2014.cls'
% LaTeX2e document class file. It is for those submitting
% articles to AAMAS 2014  conference. This file is based on
% the sig-alternate.tex example file.
% The 'sig-alternate.cls' file of ACM will produce a similar-looking,
% albeit, 'tighter' paper resulting in, invariably, fewer pages.
% than the original style ACM style.
%
% ----------------------------------------------------------------------------------------------------------------
% This .tex file (and associated .cls ) produces:
%       1) The Permission Statement
%       2) The Conference (location) Info information
%       3) The Copyright Line with AAMAS data
%       4) NO page numbers
%
% as against the acm_proc_article-sp.cls file which
% DOES NOT produce 1) through 3) above.
%
% Using 'aamas2014.cls' you don't have control
% from within the source .tex file, over both the CopyrightYear
% (defaulted to 200X) and the IFAAMAS Copyright Data
% (defaulted to X-XXXXX-XX-X/XX/XX).
% These information will be overwritten by fixed AAMAS 2014  information
% in the style files - it is NOT as you are used with ACM style files.
%
% ---------------------------------------------------------------------------------------------------------------
% This .tex source is an example which *does* use
% the .bib file (from which the .bbl file % is produced).
% REMEMBER HOWEVER: After having produced the .bbl file,
% and prior to final submission, you *NEED* to 'insert'
% your .bbl file into your source .tex file so as to provide
% ONE 'self-contained' source file.
%

% This is the document class for full camera ready papers and extended abstracts repsectively

\documentclass{aamas2014}

% if you are using PDF LaTex and you cannot find a way for producing
% letter, the following explicit settings may help

\pdfpagewidth=8.5truein
\pdfpageheight=11truein

\usepackage[ruled, vlined]{algorithm2e}
\DontPrintSemicolon

\begin{document}

% In the original styles from ACM, you would have needed to
% add meta-info here. This is not necessary for AAMAS 2014  as
% the complete copyright information is generated by the cls-files.


\title{Mixed-Initiative Coordination for Disaster Response in the Real-World}

% AUTHORS


% For initial submission, do not give author names, but the
% tracking number, instead, as the review process is blind.

% You need the command \numberofauthors to handle the 'placement
% and alignment' of the authors beneath the title.
%
% For aesthetic reasons, we recommend 'three authors at a time'
% i.e. three 'name/affiliation blocks' be placed beneath the title.
%
% NOTE: You are NOT restricted in how many 'rows' of
% "name/affiliations" may appear. We just ask that you restrict
% the number of 'columns' to three.
%
% Because of the available 'opening page real-estate'
% we ask you to refrain from putting more than six authors
% (two rows with three columns) beneath the article title.
% More than six makes the first-page appear very cluttered indeed.
%
% Use the \alignauthor commands to handle the names
% and affiliations for an 'aesthetic maximum' of six authors.
% Add names, affiliations, addresses for
% the seventh etc. author(s) as the argument for the
% \additionalauthors command.
% These 'additional authors' will be output/set for you
% without further effort on your part as the last section in
% the body of your article BEFORE References or any Appendices.

%\numberofauthors{8} %  in this sample file, there are a *total*
% of EIGHT authors. SIX appear on the 'first-page' (for formatting
% reasons) and the remaining two appear in the \additionalauthors section.
%

\numberofauthors{1}

\author{
% You can go ahead and credit any number of authors here,
% e.g. one 'row of three' or two rows (consisting of one row of three
% and a second row of one, two or three).
%
% The command \alignauthor (no curly braces needed) should
% precede each author name, affiliation/snail-mail address and
% e-mail address. Additionally, tag each line of
% affiliation/address with \affaddr, and tag the
% e-mail address with \email.
% 1st. author
\alignauthor
Paper  XXX
%Ben Trovato\titlenote{Dr.~Trovato insisted his name be first.}\\
%       \affaddr{Institute for Clarity in Documentation}\\
%       \affaddr{1932 Wallamaloo Lane}\\
%       \affaddr{Wallamaloo, New Zealand}\\
%       \email{trovato@corporation.com}
% 2nd. author
%\alignauthor
%G.K.M. Tobin\titlenote{The secretary disavows any knowledge of this author's actions.}\\
%       \affaddr{Institute for Clarity in Documentation}\\
%       \affaddr{P.O. Box 1212}\\
%       \affaddr{Dublin, Ohio 43017-6221}\\
%       \email{webmaster@marysville-ohio.com}
% 3rd. author
%\alignauthor Lars Th{\o}rv{\"a}ld\titlenote{This author is the one who did all the really hard work.}\\
%       \affaddr{The Th{\o}rv{\"a}ld Group}\\
%       \affaddr{1 Th{\o}rv{\"a}ld Circle}\\
%       \affaddr{Hekla, Iceland}\\
%       \email{larst@affiliation.org}
}

%\and  % use '\and' if you need 'another row' of author names

% 4th. author
%\alignauthor Lawrence P. Leipuner\\
%       \affaddr{Brookhaven Laboratories}\\
%       \affaddr{Brookhaven National Lab}\\
%       \affaddr{P.O. Box 5000}\\
%       \email{lleipuner@researchlabs.org}

% 5th. author
%\alignauthor Sean Fogarty\\
%       \affaddr{NASA Ames Research Center}\\
%       \affaddr{Moffett Field}\\
%       \affaddr{California 94035}\\
%       \email{fogartys@amesres.org}

% 6th. author
%\alignauthor Charles Palmer\\
%       \affaddr{Palmer Research Laboratories}\\
%      \affaddr{8600 Datapoint Drive}\\
%       \affaddr{San Antonio, Texas 78229}\\
%       \email{cpalmer@prl.com}

%\and

%% 7th. author
%\alignauthor Lawrence P. Leipuner\\
%       \affaddr{Brookhaven Laboratories}\\
%       \affaddr{Brookhaven National Lab}\\
%       \affaddr{P.O. Box 5000}\\
%       \email{lleipuner@researchlabs.org}

%% 8th. author
%\alignauthor Sean Fogarty\\
%       \affaddr{NASA Ames Research Center}\\
%       \affaddr{Moffett Field}\\
%       \affaddr{California 94035}\\
%       \email{fogartys@amesres.org}

%% 9th. author
%\alignauthor Charles Palmer\\
%       \affaddr{Palmer Research Laboratories}\\
%       \affaddr{8600 Datapoint Drive}\\
%       \affaddr{San Antonio, Texas 78229}\\
%       \email{cpalmer@prl.com}

%}

%% There's nothing stopping you putting the seventh, eighth, etc.
%% author on the opening page (as the 'third row') but we ask,
%% for aesthetic reasons that you place these 'additional authors'
%% in the \additional authors block, viz.
%\additionalauthors{Additional authors: John Smith (The Th{\o}rv{\"a}ld Group,
%email: {\texttt{jsmith@affiliation.org}}) and Julius P.~Kumquat
%(The Kumquat Consortium, email: {\texttt{jpkumquat@consortium.net}}).}
%\date{30 July 1999}
%% Just remember to make sure that the TOTAL number of authors
%% is the number that will appear on the first page PLUS the
%% number that will appear in the \additionalauthors section.

\maketitle

\begin{abstract}
The problem of allocating emergency responders to rescue tasks is a key application area for agent-based coordination algorithms. However, to date, none of the proposed approaches take into account the uncertainty predominant in disaster scenarios and have been validated in a real-world deployment. Hence, in this paper, we propose a novel algorithm, using Multi-agent Markov Decision Processes to coordinate emergency responders and deploy this algorithm in a mixed-reality game to help an agent guide human players to complete rescue tasks. In our field trials, our algorithm is shown to improve human performance and our results allow us to elucidate some of the key challenges faced when  deploying of mixed-initiative team formation algorithms. \end{abstract}

% Note that the category section should be completed after reference to the ACM Computing Classification Scheme available at
% http://www.acm.org/about/class/1998/.

\category{H.4}{Information Systems Applications}{Multi-Agent Systems}

%A category including the fourth, optional field follows...
%\category{D.2.8}{Software Engineering}{Metrics}[complexity measures, performance measures]

%General terms should be selected from the following 16 terms: Algorithms, Management, Measurement, Documentation, Performance, Design, Economics, Reliability, Experimentation, Security, Human Factors, Standardization, Languages, Theory, Legal Aspects, Verification.

\terms{Design, Human Factors, Algorithms}

%Keywords are your own choice of terms you would like the paper to be indexed by.

\keywords{Human-Agent Interaction, Coordination, Decision under Uncertainty, Adjustable Autonomy}

\section{Introduction}
\input{introduction.tex}
\input{scenario.tex}

\section{Team Coordination Algorithm}
Feng and Gopal
\begin{enumerate}
\item Feng's algorithm
\item experimental results in simulation - computational performance + no. of tasks completed in simulated settings. If possible, compare against something else.
\end{enumerate}

%[[Feng]]
Given a reasonable size of the game, the MMDP model can be huge.
For example, with 8 players and 17 tasks in a 50$\times$55 grid,
the number of possible states is more than $2\times 10^{400}$.
Thus, it is computational intractable to find the optimal plan of
the game. One useful observation is that, when making a decision,
each player first selects a task to form a team and then move to
the task location independently. In our planning algorithm, we use
this hierarchical structure to decompose the decision making
process into two level:
\begin{itemize}
  \item In the higher level, task planning algorithm is run for
      the whole team to assign the best task to each players
      given the current state.
  \item In the lower level, by given a task, path planning
      algorithm is run for each player to find the best path to
      the task from his current location.
\end{itemize}
Given the huge state space, it is intractable to find the plan for
all states offline. Therefore, we only compute plans for the
queried states online. The main process of the online hierarchical
planning algorithm is outlined in Algorithm~\ref{alg:coordination}.
The following subsections will describe the algorithms in each
level in more detail.

\begin{algorithm}[t]
  \caption{Team Coordination}
  \KwIn{the MMDP model and the current state $s$}
  \KwOut{the best joint action $\vec{a}$}
  \tcp{The task planning}
  $\{ t_i \} \gets$ compute the best task for each player $i\in I$ \;
  \ForEach{$i\in I$} {
    \tcp{The path planning}
    $a_i \gets$ compute the best path to task $t_i$ \;
  }
  \Return{$\vec{a}$}
  \label{alg:coordination}
\end{algorithm}

\subsection{Task planning}
As mentioned above, each player in the game owns a type of skill
and each task requires players with a certain combination of the
skills. The goal is to assign a task to each player that maximize
the overall performance given the current state. To do that, we
first compute all possible coalitions $\{ C_{jk} \}$ for each task
$j$ where a coalition $C_{jk} \subseteq I$ is a subset of the
players with the required skills. Then, we solve the following
optimization problem to find the best coalitions:
\begin{equation}
  \begin{array}{lll}
    \max_{x_{jk}} & \sum_{j, k} x_{jk} \cdot v(C_{jk}) & \\
    \mbox{s.t.} & x_{jk} \in \{0, 1\} & \\
    & \forall j, \sum_{k} x_{jk} \leq 1 & \mbox{(i)} \\
    & \forall i, \sum_{j, k} \delta_i(C_{jk}) \leq 1 & \mbox{(ii)}
  \end{array}
  \label{eq:cf}
\end{equation}
where $x_{jk}$ is the boolean variable to decide whether to select
coalition $C_{jk}$ for task $j$ or not, $v(C_{jk})$ is the
characteristic function for coalition $C_{jk}$, and
$\delta_i(C_{jk}) = 1$ if $i\in C_{jk}$ and 0 otherwise. Constraint
i ensures that a task $j$ is allocated at most to only one
coalition (a task does not need more than one group of players).
Constraint ii ensures that a player $i$ is assign to only one task
(a player cannot do more than one task at the same time). In the
optimization, we only consider the tasks that have not been done
and the players that are still alive. Because the players do not
change their skills and the requirements of the tasks are static
during the game, the set of all possible coalitions for each task
can be computed offline before the game.

In Equation~\ref{eq:cf}, we need to compute the value of the
characteristic function $v(C_{jk})$ for each coalition $C_{jk}$.
This is the expected value when the players in $C_{jk}$ are
assigned to task $j$. In order to compute this value, we need to
know the plan after the completion of task $j$ because not all
tasks can be done in one shot. As aforementioned, computing the
optimal plan is intractable. Thus, we estimate the value by
monte-carlo samples.

[[More detail about sampling will be added.]]

\subsection{Path planning}

In the path planning, we compute the best path for a player given
the location of his assigned task. This is a single-agent problem
that can be modeled as a MDP, $\langle S_i, A_i, P_i, R_i \rangle$,
where:
\begin{itemize}
  \item $S_i = S_r \times S_{p_i}$ is the state space. Player
      $i$ only need to consider his own state variable
      (location and health level) and the state variable of the
      radiation cloud.
  \item $A_i$ is the set of actions $i$. Player $i$ only need
      to consider the actions of staying in the same grid or
      moving to the 8 neighboring grids.
  \item $P_i = P_r \times P_{p_i}$ is the transition function.
      Player $i$ only need to consider the expanding of the
      radiation cloud and the change of his location and health
      level when moving in the grid map.
  \item $R_i$ is the reward function. Player $i$ has a small
      cost for moving around and a large penalty for being
      killed by entering the radiation cloud.
\end{itemize}
This process terminates when the location of the assigned task is
reached or the player is killed (the health level is 0) by the
radiation cloud. This is a typical MDP and can be solved by
state-of-the-art MDP solvers.

[[More detail about solving MDP will be added.]]

\section{The Atomic Orchid Platform}
Joel and Wenchao
\begin{enumerate}
\item explain the main components  and how agent is integrated
\item explain the instructions given to participants and how it mimics the disaster response problem detailed above.
\end{enumerate}
\subsection{Game scenario}
AtomicOrchid is a location-based mobile game based on the fictitious scenario of radioactive explosions creating expanding and moving radioactive clouds that pose a threat to responders on the ground (the field players), and the targets to be rescued around the game area. Field responders are assigned a specific role (e.g. `medic', `transporter', `soldier', `ambulance') and targets have specific role requirements, so that only certain teams of responders can pick up certain targets. For example, an `injured person' can only be picked up by an `ambulance' and a `medic' together. To pick up targets, the team must be collocated in the immediate proximity of the geofenced target. Furthermore, field responders must not expose themselves to radioactivity from the cloud for too long, else they risk becoming `incapacitated'.

In their mission to rescue all the targets from the radioactive zone, the field responders are supported by (at least one) person in a centrally located HQ room, and the planning agent that sends the next task to the team of field responders [assuming the agent will have been described in detail already].

\subsection{Player interfaces}
Field responders are equipped with a `mobile responder tool' providing sensing and awareness capabilities in three tabs (geiger counter, map, messaging and tasks; see figure XX). One tab shows a reading of radioactivity, player health level (based on exposure), and a GPS-enabled map of the game area to locate fellow responders, the targets to be rescued and the drop off zones for the targets. Another tab provides a broadcast messaging interface to communicate with fellow responders (field responders and HQ). Another tab shows the team and task allocation dynamically provided by the agent. Notifications are used to alert both to new messages and task allocations.

HQ is manned by at least one player who has at their disposal an `HQ dashboard' that provides an overview of the game area, including real-time information of the players' locations (see figure XX). The dashboard provides a broadcast messaging widget, and a player status widget so that the responders' exposure and health levels can be monitored. HQ can further monitor the   current team and task allocations by the agent. Importantly, only HQ has a view of the radioactive cloud, depicted as a heatmap. `Hotter' zones correspond with higher levels of radioactivity.

\subsection{Planning agent}
[Wenchao. Describe how the agent works (not implementation detail, add that in subsection below), i.e., when it is polled, what information is being exchanged, and how the team/task allocation is being constructed from that and sent.]

\subsection{System architecture}
[Wenchao: adapt this to version 2.0] AtomicOrchid is based on the open-sourced geo-fencing game MapAttack\footnote{http://mapattack.org} that has been iteratively developed for a responsive, (relatively) scalable experience.  The location-based game is realized by client-server architecture, relying on real-time data streaming between client and server.

The client-server architecture is depicted in figure XX. Client-side requests for for less dynamic content use HTTP. Frequent events, such as location updates and radiation exposure, are streamed to clients to avoid the overhead of HTTP. In this way, field responders are kept informed in near real-time.

The planning agent agent ... [add implementation detail]

The platform is built using the geoloqi platform, Sinatra for Ruby, and state-of-the-art web technologies such as socket.io, node.js, redis and Synchrony for Sinatra, and the Google Maps API. Open source mobile client apps that are part native, part browser based exist for iPhone and Android; we adapted an Android app to build the mobile responder app.

\section{Pilot Study}
Joel and Wenchao
\begin{enumerate}
\item Explain setup of experiment - area of interest + setup of tasks
\item Explain evaluation = quantitative and qualitative.
\end{enumerate}
\paragraph{Metrics}
\begin{itemize}
\item{Comparisons between with/without agent versions for the below:}
\item{Performance of FR: number of tasks completed, time on task?, number of messages sent, number of teams formed and disbanded, time on team, acknowledgements of tasks}
\item{Messages: classification}
\item{Health}
\item{Distance travelled}
\item{HQ: number of agent monitoring actions (clicks), number of 'supporting'/related messages (e.g., enforcement, contradictions/overriding)}
\item{Agent performance: number of instructions, number of replanning steps, replanning robustness (diversion of task allocation compared to previous step)}
\item{Following instructions ('obedience'): number of instructions followed vs. not followed (incl. number of HQ interventions/overriding agent allocation), instruction handling diagram}
\item
\end{itemize}
\subsection{Conclusions}
\bibliography{citations}
\end{document}
